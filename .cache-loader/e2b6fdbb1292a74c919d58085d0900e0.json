{"remainingRequest":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\babel-loader\\lib\\index.js?cacheDirectory=true!D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\app\\src\\module\\panoBox\\SWBoxTilesModule.js","dependencies":[{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\app\\src\\module\\panoBox\\SWBoxTilesModule.js","mtime":1531466373995},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1526631545426},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\babel-loader\\lib\\index.js","mtime":1520329890000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n        value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /* global THREE*/\n\nvar _SWConstants = require('../../tool/SWConstants');\n\nvar _SWTool = require('../../tool/SWTool');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * 全景盒子瓦片对象\r\n */\nvar SWBoxTilesModule = function () {\n        /**\r\n         * @param {Number} no 所属面编号\r\n         * @param {Number} x 行\r\n         * @param {Number} y 列\r\n         * @param {Object} meshparent 父类对象\r\n         * @param {THREE.Group} path 图片链接的前半截地址\r\n         */\n        function SWBoxTilesModule(no, x, y, meshparent, path) {\n                _classCallCheck(this, SWBoxTilesModule);\n\n                this.loadImageType = 0; //0-未加载图片 1-正在加载 2-加载成功 3-加载失败\n\n                this.faceNo = no;\n\n                this.row = x;\n\n                this.line = y;\n\n                this.meshParent = meshparent;\n\n                this.boxPath = path;\n\n                this.lineNum = 8;\n\n                this.planeW = _SWConstants.c_FaceDistance / this.lineNum;\n\n                this.geometry = new THREE.PlaneGeometry(this.planeW, this.planeW, 1, 1);\n\n                this.material = new THREE.MeshBasicMaterial({ map: null });\n\n                this.mesh = new THREE.Mesh(this.geometry, this.material);\n\n                this.mesh.name = '\\u7F16\\u53F7:' + this.faceNo + '_' + this.row + '_' + this.line;\n\n                this.mesh.position.x = -_SWConstants.c_FaceDistance * 0.5 + this.planeW * 0.5 + (this.line - 1) * this.planeW;\n\n                this.mesh.position.y = _SWConstants.c_FaceDistance * 0.5 - this.planeW * 0.5 - (this.row - 1) * this.planeW;\n\n                this.mesh.position.z = 1;\n\n                this.mesh.userData.depthlevel = 100;\n\n                this.loadTilesTexture();\n        }\n\n        /**\r\n         * 加载瓦片贴图\r\n         */\n\n\n        _createClass(SWBoxTilesModule, [{\n                key: 'loadTilesTexture',\n                value: function loadTilesTexture() {\n                        var _this = this;\n\n                        var ss = (this.row - 1) * this.lineNum + this.line > 9 ? (this.row - 1) * this.lineNum + this.line : '0' + ((this.row - 1) * this.lineNum + this.line);\n\n                        var path = this.boxPath + '/4/sw_' + this.faceNo + '_' + ss + '.jpg';\n\n                        // 实例化一个加载器\n                        var loader = new THREE.TextureLoader();\n\n                        // 加载资源\n                        loader.load(\n                        // 资源URL\n                        path,\n                        // 加载成功之后调用\n                        function (texture) {\n\n                                _this.geometry.visible = true;\n\n                                texture.mapping = THREE.UVMapping;\n\n                                texture.magFilter = THREE.LinearFilter;\n\n                                texture.minFilter = THREE.LinearFilter;\n\n                                texture.type = THREE.FloatType;\n\n                                texture.anisotropy = 1;\n\n                                _this.mesh.material.map = texture;\n\n                                _this.mesh.material.map.needsUpdate = true;\n\n                                _this.loadImageType = 2;\n\n                                _this.meshParent.add(_this.mesh);\n                        },\n                        // 加载中\n                        function (xhr) {\n                                _this.loadImageType = 1;\n                        },\n                        // 加载失败\n                        function (xhr) {\n                                console.log('\\u56FE\\u7247\\u52A0\\u8F7D\\u5931\\u8D25\\uFF1A' + path);\n                                _this.loadImageType = 3;\n                        });\n                }\n        }, {\n                key: 'clearTile',\n                value: function clearTile() {\n\n                        (0, _SWTool.disposeNode)(this.mesh);\n                }\n        }]);\n\n        return SWBoxTilesModule;\n}();\n\nexports.default = SWBoxTilesModule;",null]}