{"remainingRequest":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\babel-loader\\lib\\index.js?cacheDirectory=true!D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\app\\src\\tool\\SWInitializeInstance.js","dependencies":[{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\app\\src\\tool\\SWInitializeInstance.js","mtime":1536829525378},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1526631545426},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\babel-loader\\lib\\index.js","mtime":1520329890000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.AddOldArrow = AddOldArrow;\nexports.AddNewArrow = AddNewArrow;\nexports.deleteAllArrow = deleteAllArrow;\nexports.jumpSite = jumpSite;\nexports.deleteAll = deleteAll;\nexports.AddMarkerMesh = AddMarkerMesh;\nexports.LoadPreviewImage = LoadPreviewImage;\nexports.rotateByWallClick = rotateByWallClick;\nexports.JumpLookMarker = JumpLookMarker;\n\nvar _SWConstants = require('./SWConstants');\n\nvar constants = _interopRequireWildcard(_SWConstants);\n\nvar _SWTool = require('./SWTool');\n\nvar _SWMarkerArrowModule = require('../module/marker/SWMarkerArrowModule');\n\nvar _SWMarkerArrowModule2 = _interopRequireDefault(_SWMarkerArrowModule);\n\nvar _SWMarkerSingleModule = require('../module/marker/SWMarkerSingleModule');\n\nvar _SWMarkerSingleModule2 = _interopRequireDefault(_SWMarkerSingleModule);\n\nvar _SWMarkerMoreModule = require('../module/marker/SWMarkerMoreModule');\n\nvar _SWMarkerMoreModule2 = _interopRequireDefault(_SWMarkerMoreModule);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/**\r\n * 初始化实例对象\r\n */\n\n/**\r\n * 添加老箭头数据\r\n * */\nfunction AddOldArrow() {\n    constants.c_AdjacentPanoInfoArr.map(function (obj) {\n\n        constants.c_arrowArr.push(new _SWMarkerArrowModule2.default(obj));\n    });\n\n    constants.sw_getService.getNewArrow();\n}\n\n/**\r\n * 添加新箭头数据\r\n * */\nfunction AddNewArrow() {\n\n    var boo = true;\n\n    if (constants.c_arrowArr.length == 0) {\n\n        boo = false;\n    }\n\n    constants.c_ArrowPanoInfoArr.map(function (obj) {\n\n        if (boo) {\n\n            constants.c_arrowArr.map(function (item) {\n\n                if (item.arrowData.srcPanoID === obj.srcPanoID && item.arrowData.dstPanoID === obj.dstPanoID) {\n\n                    item.updateLocation(obj);\n                }\n            });\n        } else {\n\n            constants.c_arrowArr.push(new _SWMarkerArrowModule2.default(obj));\n        }\n    });\n}\n\n/**\r\n * 清除所有箭头\r\n * */\nfunction deleteAllArrow() {\n\n    constants.c_arrowArr.map(function (item) {\n\n        if (item) item.clearArrow();\n    });\n    constants.c_arrowArr.length = 0;\n}\n\n/**\r\n * 跳站点\r\n * @param {String} panoID 站点ID\r\n */\nfunction jumpSite(panoID) {\n\n    deleteAll();\n\n    constants.sw_getService.getPanoByID(panoID);\n}\n\n/**跳转时需要清除所有的东西 */\nfunction deleteAll() {\n\n    deleteAllArrow();\n\n    constants.sw_wallMesh.clear();\n\n    constants.sw_wallProbeSurface.wallProbeSurfaceVisible(0, 0);\n\n    constants.c_markerMeshArr.map(function (item) {\n\n        item.clear();\n    });\n\n    constants.sw_measure.clear();\n}\n\n/**\r\n * 添加标注\r\n * */\nfunction AddMarkerMesh() {\n\n    constants.c_markerInfoArr.map(function (obj) {\n\n        if (obj.centerX != 0 && obj.centerY != 0) {\n\n            constants.c_markerMeshArr.push(new _SWMarkerSingleModule2.default(obj));\n        } else {\n\n            constants.c_markerMeshArr.push(new _SWMarkerMoreModule2.default(obj));\n        }\n\n        if (constants.c_JumpMarkerID != \"\" && constants.c_JumpMarkerID == obj.markerID) {\n\n            constants.c_JumpMarkerID = \"\";\n\n            JumpLookMarker(obj);\n        }\n    });\n}\n\n/**加载完成之后调用 */\nfunction LoadPreviewImage() {\n\n    if (constants.c_isWallClickRotateBoo) {\n\n        constants.c_isWallClickRotateBoo = false;\n\n        rotateByWallClick();\n    }\n\n    AddMarkerMesh();\n}\n\n/**\r\n * 跳转之后看向某一个点\r\n * */\nfunction rotateByWallClick() {\n\n    var aa = constants.c_wallClickRotateV3.clone().sub(constants.c_StationInfo.point.clone());\n\n    var bb = aa.clone().applyMatrix4(constants.c_DS3ToOpenGLMx4);\n\n    var swvg = (0, _SWTool.Vector3ToVP)(new THREE.Vector3(bb.z, -bb.y, bb.x));\n\n    (0, _SWTool.setCameraAngle)(swvg.Yaw, swvg.Pitch, true);\n};\n\n/**\r\n * 跳转之后看向标注的中心点\r\n * @param {SWMarkerInfo} obj 标注点对象\r\n */\nfunction JumpLookMarker(obj) {\n\n    if (obj.centerX != 0 && obj.centerY != 0 && obj.centerZ != 0) {\n\n        (0, _SWTool.setCameraAngle)(obj.centerX, obj.centerY, true);\n    } else {\n\n        var yaw = [],\n            pitch = [];\n\n        obj.points.map(function (objs) {\n\n            yaw.push(parseFloat(objs.yaw));\n\n            pitch.push(parseFloat(objs.pitch));\n        });\n\n        var yawArr = yaw.sort(function (a, b) {\n            if (a > b) {\n                return 1;\n            } else {\n                return -1;\n            }\n        });\n\n        var pitchArr = pitch.sort(function (a, b) {\n            if (a > b) {\n                return 1;\n            } else {\n                return -1;\n            }\n        });\n\n        var num = yawArr[yawArr.length - 1];\n\n        if (yawArr[0] < 100 && yawArr[yawArr.length - 1] > 300) {\n\n            num = 360 - yawArr[yawArr.length - 1];\n        }\n\n        var yy = yawArr[0] + (num - yawArr[0]) * 0.5;\n\n        var pp = pitchArr[0] + (pitchArr[pitchArr.length - 1] - pitchArr[0]) * 0.5;\n\n        (0, _SWTool.setCameraAngle)(yy, pp, true);\n    }\n}",{"version":3,"sources":["app\\src\\tool\\SWInitializeInstance.js"],"names":["AddOldArrow","AddNewArrow","deleteAllArrow","jumpSite","deleteAll","AddMarkerMesh","LoadPreviewImage","rotateByWallClick","JumpLookMarker","constants","c_AdjacentPanoInfoArr","map","obj","c_arrowArr","push","SWMarkerArrowModule","sw_getService","getNewArrow","boo","length","c_ArrowPanoInfoArr","item","arrowData","srcPanoID","dstPanoID","updateLocation","clearArrow","panoID","getPanoByID","sw_wallMesh","clear","sw_wallProbeSurface","wallProbeSurfaceVisible","c_markerMeshArr","sw_measure","c_markerInfoArr","centerX","centerY","SWMarkerSingleModule","SWMarkerMoreModule","c_JumpMarkerID","markerID","c_isWallClickRotateBoo","aa","c_wallClickRotateV3","clone","sub","c_StationInfo","point","bb","applyMatrix4","c_DS3ToOpenGLMx4","swvg","THREE","Vector3","z","y","x","Yaw","Pitch","centerZ","yaw","pitch","points","objs","parseFloat","yawArr","sort","a","b","pitchArr","num","yy","pp"],"mappings":"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","file":"SWInitializeInstance.js","sourceRoot":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano","sourcesContent":["import * as constants from './SWConstants';\r\nimport {\r\n    setCameraAngle,Vector3ToVP\r\n} from './SWTool';\r\nimport SWMarkerArrowModule from '../module/marker/SWMarkerArrowModule';\r\nimport SWMarkerSingleModule from '../module/marker/SWMarkerSingleModule';\r\nimport SWMarkerMoreModule from '../module/marker/SWMarkerMoreModule';\r\n\r\n/**\r\n * 初始化实例对象\r\n */\r\n\r\n/**\r\n * 添加老箭头数据\r\n * */\r\nexport function AddOldArrow() {\r\n    constants.c_AdjacentPanoInfoArr.map((obj) => {\r\n\r\n        constants.c_arrowArr.push(new SWMarkerArrowModule(obj));\r\n\r\n    });\r\n\r\n    constants.sw_getService.getNewArrow();\r\n}\r\n\r\n/**\r\n * 添加新箭头数据\r\n * */\r\nexport function AddNewArrow() {\r\n\r\n    let boo = true;\r\n\r\n    if (constants.c_arrowArr.length == 0) {\r\n\r\n        boo = false;\r\n    }\r\n\r\n    constants.c_ArrowPanoInfoArr.map((obj) => {\r\n\r\n        if (boo) {\r\n\r\n            constants.c_arrowArr.map((item) => {\r\n\r\n                if (item.arrowData.srcPanoID === obj.srcPanoID && item.arrowData.dstPanoID === obj.dstPanoID) {\r\n\r\n                    item.updateLocation(obj);\r\n\r\n                }\r\n\r\n            });\r\n\r\n        } else {\r\n\r\n            constants.c_arrowArr.push(new SWMarkerArrowModule(obj));\r\n\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * 清除所有箭头\r\n * */\r\nexport function deleteAllArrow() {\r\n\r\n    constants.c_arrowArr.map((item) => {\r\n\r\n        if (item) item.clearArrow();\r\n\r\n    });\r\n    constants.c_arrowArr.length = 0;\r\n}\r\n\r\n/**\r\n * 跳站点\r\n * @param {String} panoID 站点ID\r\n */\r\nexport function jumpSite(panoID) {\r\n\r\n    deleteAll();\r\n\r\n    constants.sw_getService.getPanoByID(panoID);\r\n}\r\n\r\n/**跳转时需要清除所有的东西 */\r\nexport function deleteAll() {\r\n\r\n    deleteAllArrow();\r\n\r\n    constants.sw_wallMesh.clear();\r\n\r\n    constants.sw_wallProbeSurface.wallProbeSurfaceVisible(0, 0);\r\n\r\n    constants.c_markerMeshArr.map((item) => {\r\n\r\n        item.clear();\r\n\r\n    });\r\n\r\n    constants.sw_measure.clear();\r\n}\r\n\r\n/**\r\n * 添加标注\r\n * */\r\nexport function AddMarkerMesh() {\r\n\r\n    constants.c_markerInfoArr.map((obj) => {\r\n\r\n        if (obj.centerX != 0 && obj.centerY != 0) {\r\n\r\n            constants.c_markerMeshArr.push(new SWMarkerSingleModule(obj));\r\n\r\n        } else {\r\n\r\n            constants.c_markerMeshArr.push(new SWMarkerMoreModule(obj));\r\n\r\n        }\r\n\r\n        if (constants.c_JumpMarkerID != \"\" && constants.c_JumpMarkerID == obj.markerID) {\r\n\r\n            constants.c_JumpMarkerID = \"\";\r\n\r\n            JumpLookMarker(obj);\r\n\r\n        }\r\n    });\r\n}\r\n\r\n/**加载完成之后调用 */\r\nexport function LoadPreviewImage(){\r\n\r\n    if (constants.c_isWallClickRotateBoo) {\r\n\r\n        constants.c_isWallClickRotateBoo = false;\r\n\r\n        rotateByWallClick();\r\n    }\r\n\r\n    AddMarkerMesh();\r\n}\r\n\r\n/**\r\n * 跳转之后看向某一个点\r\n * */\r\nexport function rotateByWallClick() {\r\n\r\n    let aa = constants.c_wallClickRotateV3.clone().sub(constants.c_StationInfo.point.clone());\r\n\r\n    let bb = aa.clone().applyMatrix4(constants.c_DS3ToOpenGLMx4);\r\n\r\n    let swvg = Vector3ToVP(new THREE.Vector3(bb.z, -bb.y, bb.x));\r\n\r\n    setCameraAngle(swvg.Yaw,  swvg.Pitch, true);\r\n};\r\n\r\n/**\r\n * 跳转之后看向标注的中心点\r\n * @param {SWMarkerInfo} obj 标注点对象\r\n */\r\nexport function JumpLookMarker(obj) {\r\n\r\n    if (obj.centerX != 0 && obj.centerY != 0 && obj.centerZ != 0) {\r\n\r\n        setCameraAngle(obj.centerX, obj.centerY, true);\r\n\r\n    } else {\r\n\r\n        let yaw = [],\r\n            pitch = [];\r\n\r\n        obj.points.map((objs) => {\r\n\r\n            yaw.push(parseFloat(objs.yaw));\r\n\r\n            pitch.push(parseFloat(objs.pitch));\r\n\r\n        });\r\n\r\n        let yawArr = yaw.sort(function (a, b) {\r\n            if (a > b) {\r\n                return 1;\r\n            } else {\r\n                return -1;\r\n            }\r\n        });\r\n\r\n        let pitchArr = pitch.sort(function (a, b) {\r\n            if (a > b) {\r\n                return 1;\r\n            } else {\r\n                return -1;\r\n            }\r\n        });\r\n\r\n        let num = yawArr[yawArr.length - 1];\r\n\r\n        if (yawArr[0] < 100 && yawArr[yawArr.length - 1] > 300) {\r\n\r\n            num = 360 - yawArr[yawArr.length - 1];\r\n\r\n        }\r\n\r\n        let yy = yawArr[0] + (num - yawArr[0]) * 0.5;\r\n\r\n        let pp = pitchArr[0] + (pitchArr[pitchArr.length - 1] - pitchArr[0]) * 0.5;\r\n\r\n        setCameraAngle(yy, pp, true);\r\n    }\r\n}"]}]}