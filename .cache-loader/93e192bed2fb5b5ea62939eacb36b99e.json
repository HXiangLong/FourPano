{"remainingRequest":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\babel-loader\\lib\\index.js?cacheDirectory=true!D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\app\\src\\module\\laser\\SWGroundModule.js","dependencies":[{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\app\\src\\module\\laser\\SWGroundModule.js","mtime":1537351157995},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1538971317145},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\babel-loader\\lib\\index.js","mtime":1520329890000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /* global THREE*/\n\nvar _SWConstants = require('../../tool/SWConstants');\n\nvar _SWTool = require('../../tool/SWTool');\n\nvar _SWInitializeInstance = require('../../tool/SWInitializeInstance');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * 地面面片对象\r\n */\nvar SWGroundModule = function () {\n    function SWGroundModule() {\n        _classCallCheck(this, SWGroundModule);\n\n        this.groundMesh = undefined;\n        this.ifClick = false;\n        this.startPoint = new THREE.Vector2();\n\n        this.groundDisplaySize = -500;\n        this.probeSurface = null;\n        this.textDiv = null;\n    }\n\n    /**\r\n     * 绘制底层面片\r\n     */\n\n\n    _createClass(SWGroundModule, [{\n        key: 'drawGroundFace',\n        value: function drawGroundFace() {\n            var _this = this;\n\n            if (!this.groundMesh) {\n                var groundMaterial = new THREE.MeshBasicMaterial({\n                    color: 0xff00ff,\n                    depthTest: false,\n                    transparent: true,\n                    side: 2,\n                    opacity: 0\n                });\n                groundMaterial.shading = THREE.SmoothShading;\n                groundMaterial.reflectivity = 0;\n\n                var groundGeometry = new THREE.CircleGeometry(_SWConstants.c_FaceDistance * 0.45, 32);\n                this.groundMesh = new THREE.Mesh(groundGeometry, groundMaterial);\n                this.groundMesh.position.copy(new THREE.Vector3(0, this.groundDisplaySize, 0));\n                this.groundMesh.rotation.x = THREE.Math.degToRad(-90);\n                this.groundMesh.name = \"ground face\";\n                this.groundMesh.userData.depthlevel = 3;\n                _SWConstants.scene.add(this.groundMesh);\n\n                //进入\n                this.groundMesh.mouseOver = function (e, obj) {\n\n                    _SWConstants.sw_wallProbeSurface.wallProbeSurfaceVisible(2);\n                };\n\n                //出去\n                this.groundMesh.mouseOut = function (e, obj) {\n\n                    _SWConstants.sw_wallProbeSurface.wallProbeSurfaceVisible(0);\n                };\n\n                //移动\n                this.groundMesh.mouseMove = function (e, obj) {\n\n                    _SWConstants.sw_wallProbeSurface.groundFaceMove(obj);\n                };\n\n                //鼠标弹起\n                this.groundMesh.mouseUp = function (e, obj) {\n\n                    var event = e || window.event;\n\n                    var v3 = new THREE.Vector2(event.clientX, event.clientY);\n\n                    var boo = v3.equals(_this.startPoint);\n\n                    if (boo) {\n                        //测量状态开启\n                        if (_SWConstants.c_isMeasureStatus) {\n                            _SWConstants.sw_measure.addPoint(obj, 2);\n                            return;\n                        }\n                        var _v = (0, _SWTool.getPanoRealPoint)(obj, 2.5);\n\n                        (0, _SWInitializeInstance.deleteAll)();\n\n                        _SWConstants.sw_getService.getOtherPanoByPosition(_v.x, _v.y, _v.z, _SWConstants.c_StationInfo.imageID);\n                    }\n                };\n\n                //鼠标按下\n                this.groundMesh.mouseDown = function (e) {\n\n                    var event = e || window.event;\n\n                    _this.startPoint.x = event.clientX;\n\n                    _this.startPoint.y = event.clientY;\n                };\n            }\n        }\n    }]);\n\n    return SWGroundModule;\n}();\n\nexports.default = SWGroundModule;",{"version":3,"sources":["app\\src\\module\\laser\\SWGroundModule.js"],"names":["SWGroundModule","groundMesh","undefined","ifClick","startPoint","THREE","Vector2","groundDisplaySize","probeSurface","textDiv","groundMaterial","MeshBasicMaterial","color","depthTest","transparent","side","opacity","shading","SmoothShading","reflectivity","groundGeometry","CircleGeometry","c_FaceDistance","Mesh","position","copy","Vector3","rotation","x","Math","degToRad","name","userData","depthlevel","scene","add","mouseOver","e","obj","sw_wallProbeSurface","wallProbeSurfaceVisible","mouseOut","mouseMove","groundFaceMove","mouseUp","event","window","v3","clientX","clientY","boo","equals","c_isMeasureStatus","sw_measure","addPoint","sw_getService","getOtherPanoByPosition","y","z","c_StationInfo","imageID","mouseDown"],"mappings":"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","file":"SWGroundModule.js","sourceRoot":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano","sourcesContent":["/* global THREE*/\r\n\r\nimport {\r\n    scene,\r\n    c_FaceDistance,\r\n    sw_getService,\r\n    c_StationInfo,\r\n    sw_wallProbeSurface,\r\n    c_isMeasureStatus,\r\n    sw_measure\r\n} from '../../tool/SWConstants';\r\nimport { getPanoRealPoint } from '../../tool/SWTool';\r\nimport { deleteAll } from '../../tool/SWInitializeInstance';\r\n\r\n/**\r\n * 地面面片对象\r\n */\r\nclass SWGroundModule {\r\n    constructor() {\r\n        this.groundMesh = undefined;\r\n        this.ifClick = false;\r\n        this.startPoint = new THREE.Vector2();\r\n\r\n        this.groundDisplaySize = -500;\r\n        this.probeSurface = null;\r\n        this.textDiv = null;\r\n    }\r\n\r\n    /**\r\n     * 绘制底层面片\r\n     */\r\n    drawGroundFace() {\r\n        if (!this.groundMesh) {\r\n            let groundMaterial = new THREE.MeshBasicMaterial({\r\n                color: 0xff00ff,\r\n                depthTest: false,\r\n                transparent: true,\r\n                side: 2,\r\n                opacity: 0\r\n            });\r\n            groundMaterial.shading = THREE.SmoothShading;\r\n            groundMaterial.reflectivity = 0;\r\n\r\n            var groundGeometry = new THREE.CircleGeometry(c_FaceDistance * 0.45, 32);\r\n            this.groundMesh = new THREE.Mesh(groundGeometry, groundMaterial);\r\n            this.groundMesh.position.copy(new THREE.Vector3(0, this.groundDisplaySize, 0));\r\n            this.groundMesh.rotation.x = THREE.Math.degToRad(-90);\r\n            this.groundMesh.name = \"ground face\";\r\n            this.groundMesh.userData.depthlevel = 3;\r\n            scene.add(this.groundMesh);\r\n\r\n            //进入\r\n            this.groundMesh.mouseOver = (e, obj) => {\r\n\r\n                sw_wallProbeSurface.wallProbeSurfaceVisible(2);\r\n\r\n            }\r\n\r\n            //出去\r\n            this.groundMesh.mouseOut = (e, obj) => {\r\n\r\n                sw_wallProbeSurface.wallProbeSurfaceVisible(0);\r\n\r\n            }\r\n\r\n            //移动\r\n            this.groundMesh.mouseMove = (e, obj) => {\r\n\r\n                sw_wallProbeSurface.groundFaceMove(obj);\r\n\r\n            }\r\n\r\n            //鼠标弹起\r\n            this.groundMesh.mouseUp = (e, obj) => {\r\n\r\n                var event = e || window.event;\r\n\r\n                var v3 = new THREE.Vector2(event.clientX, event.clientY);\r\n\r\n                var boo = v3.equals(this.startPoint);\r\n\r\n                if (boo) {\r\n                    //测量状态开启\r\n                    if (c_isMeasureStatus) {\r\n                        sw_measure.addPoint(obj, 2);\r\n                        return;\r\n                    }\r\n                    let v3 = getPanoRealPoint(obj, 2.5);\r\n\r\n                    deleteAll();\r\n\r\n                    sw_getService.getOtherPanoByPosition(v3.x, v3.y, v3.z, c_StationInfo.imageID);\r\n                }\r\n            }\r\n\r\n            //鼠标按下\r\n            this.groundMesh.mouseDown = (e) => {\r\n\r\n                let event = e || window.event;\r\n\r\n                this.startPoint.x = event.clientX;\r\n\r\n                this.startPoint.y = event.clientY;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default SWGroundModule;"]}]}