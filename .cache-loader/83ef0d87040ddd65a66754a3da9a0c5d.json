{"remainingRequest":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\babel-loader\\lib\\index.js!D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\eslint-loader\\index.js??ref--5-0!D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\app\\src\\server\\ServerData.js","dependencies":[{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\app\\src\\server\\ServerData.js","mtime":1526891268516},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\.babelrc","mtime":1526554899270},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1526631545426},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\babel-loader\\lib\\index.js","mtime":1520329890000},{"path":"D:\\02数文\\WebProject\\NodeAllProject\\FourPano\\node_modules\\eslint-loader\\index.js","mtime":1519638534000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); // import * as jsonData from '../tool/ExternalConst';\n\n\nvar _Constants = require('../tool/Constants');\n\nvar constants = _interopRequireWildcard(_Constants);\n\nvar _ArrowInfo = require('../data/ArrowInfo');\n\nvar _ArrowInfo2 = _interopRequireDefault(_ArrowInfo);\n\nvar _ExhibitsInfo = require('../data/ExhibitsInfo');\n\nvar _ExhibitsInfo2 = _interopRequireDefault(_ExhibitsInfo);\n\nvar _FacadeByPanoIDInfo = require('../data/FacadeByPanoIDInfo');\n\nvar _FacadeByPanoIDInfo2 = _interopRequireDefault(_FacadeByPanoIDInfo);\n\nvar _FloorsInfo = require('../data/FloorsInfo');\n\nvar _FloorsInfo2 = _interopRequireDefault(_FloorsInfo);\n\nvar _MarkerInfo = require('../data/MarkerInfo');\n\nvar _MarkerInfo2 = _interopRequireDefault(_MarkerInfo);\n\nvar _MultiDataByParentIDInfo = require('../data/MultiDataByParentIDInfo');\n\nvar _MultiDataByParentIDInfo2 = _interopRequireDefault(_MultiDataByParentIDInfo);\n\nvar _ThumbnailsInfo = require('../data/ThumbnailsInfo');\n\nvar _ThumbnailsInfo2 = _interopRequireDefault(_ThumbnailsInfo);\n\nvar _StationInfo = require('../data/StationInfo');\n\nvar _StationInfo2 = _interopRequireDefault(_StationInfo);\n\nvar _http = require('http');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar jsonData = require('../tool/ExternalConst.js');\n\n/**\r\n * 获取服务器数据\r\n */\n\nvar ServerData = function () {\n    function ServerData() {\n        _classCallCheck(this, ServerData);\n\n        /**博物馆ID*/\n        this.museumID = \"\";\n        /**建筑ID*/\n        this.displayID = \"\";\n        /**底层数据库链接*/\n        this.serverURL = \"\";\n        /**业务数据库链接*/\n        this.musServerURL = \"\";\n        /**默认第一站全景ID*/\n        this.firstPanoID = \"\";\n        /**数据存放处*/\n        this.resourcesUrl = \"\";\n        /**功能对象*/\n        this.featuresObj = {};\n    }\n\n    /**\r\n     * 获取配置文件数据\r\n     */\n\n\n    _createClass(ServerData, [{\n        key: 'getConfig',\n        value: function getConfig() {\n            console.info(jsonData);\n            this.museumID = jsonData.museumID;\n            this.displayID = jsonData.displayID;\n            this.serverURL = jsonData.serverUrl;\n            this.musServerURL = jsonData.musServerUrl;\n            this.firstPanoID = jsonData.firstPanoID;\n            this.resourcesUrl = jsonData.resourcesUrl;\n            this.featuresObj = jsonData.data;\n            this.getPanoByID(this.firstPanoID);\n            this.getAllFloorsForBuilding();\n        }\n\n        /**\r\n         * 获得所有楼层站点信息\r\n         */\n\n    }, {\n        key: 'getAllFloorsForBuilding',\n        value: function getAllFloorsForBuilding() {\n            var urls = \"?method=GetAllFloorsForBuilding&buildingID=\" + this.displayID + \"&random=\" + Math.random() * 10;\n            $.ajax({\n                url: this.musServerURL + urls,\n                type: 'GET',\n                cache: true,\n                dataType: 'json',\n                error: function error(data) {\n                    console.log(\"网络连接错误，请刷新重试！\");\n                },\n                success: function success(data) {\n                    if (data.Floors) {\n                        data.Floors.map(function (obj) {\n                            new _FloorsInfo2.default(obj);\n                        });\n                        console.log(constants.c_FloorsMapTable);\n                        // if (SWPanoView.swMinMap) {\n                        //     SWPanoView.swMinMap.init();\n                        // }\n                    }\n                }\n            });\n        }\n\n        /**\r\n         * 获得当前站点信息\r\n         * @param {String} panoid 站点ID\r\n         */\n\n    }, {\n        key: 'getPanoByID',\n        value: function getPanoByID(panoid) {\n            var url = \"/GetPanoByID?ImageID=\" + panoid;\n            $.ajax({\n                url: this.serverURL + url,\n                type: 'GET',\n                cache: true,\n                dataType: 'json',\n                error: function error(data) {\n                    console.log(\"网络连接错误，请刷新重试！\");\n                },\n                success: function success(data) {\n                    if (data.GetPanoByIDResult) {\n                        if (!constants.c_StationInfo || constants.c_isPreviewImageLoadEnd && constants.c_StationInfo.panoID != data.GetPanoByIDResult.ImageID) {\n                            constants.c_isPreviewImageLoadEnd = false;\n                            constants.c_StationInfo = new _StationInfo2.default(data.GetPanoByIDResult);\n                            // if (SWPanoView.swSkySphere) {\n                            //     SWPanoView.swSkySphere.initSkySphere();\n                            // } else if (SWPanoView.swSkyBox) {\n                            //     SWPanoView.swSkyBox.initBox(SWPanoView.stationInfo);\n                            // }\n                        }\n                    }\n                }\n            });\n        }\n\n        /**\r\n         * 激光点云面片数据\r\n         * */\n\n    }, {\n        key: 'getFacadeByPanoID',\n        value: function getFacadeByPanoID() {\n            var url = \"/GetFacadeByPanoID/?Z=\" + constants.c_StationInfo.nz + \"&PanoID=\" + constants.c_StationInfo.panoID + \"&TolerateZ=\" + 5;\n            $.ajax({\n                url: this.serverURL + url,\n                type: 'GET',\n                cache: true,\n                dataType: 'json',\n                error: function error(data) {\n                    console.log(\"网络连接错误，请刷新重试！\");\n                },\n                success: function success(data) {\n                    if (data.GetFacadeByPanoIDResult) {\n                        constants.c_facadeByPanoIDInfoArr.length = 0;\n                        data.GetFacadeByPanoIDResult.map(function (obj) {\n                            constants.c_facadeByPanoIDInfoArr.push(new _FacadeByPanoIDInfo2.default(obj));\n                        });\n                        // //绘制墙面片\n                        // SWPanoView.swWallMesh.init();\n                        // SWPanoView.swGroundMesh.groundMeshShow(true);\n                        // if (SWPanoView.isWallClickRotateBoo) {\n                        //     SWPanoView.isWallClickRotateBoo = false;\n                        //     SWPanoView.rotateByWallClick();\n                        // }\n                    }\n                    // else {\n                    //     SWPanoView.swGroundMesh.groundMeshShow(false);\n                    // }\n                }\n            });\n        }\n    }, {\n        key: 'getOldArrow',\n\n\n        /**\r\n         * 获取老箭头方法\r\n         * */\n        value: function getOldArrow() {\n            var url = \"/GetAdjacentPano/?date=\" + Math.random() * 100 + \"&ImageID=\" + constants.c_StationInfo.panoID;\n            $.ajax({\n                url: this.serverURL + url,\n                type: 'GET',\n                cache: true,\n                dataType: 'json',\n                error: function error(data) {\n                    console.log(\"网络连接错误，请刷新重试！\");\n                },\n                success: function success(data) {\n                    if (data.GetAdjacentPanoResult) {\n                        constants.c_AdjacentPanoInfoArr.length = 0;\n                        data.GetAdjacentPanoResult.map(function (obj) {\n                            constants.c_AdjacentPanoInfoArr.push(new _ArrowInfo2.default(obj, 1));\n                        });\n                        // SWPanoView.AddArrow();\n                    }\n                }\n            });\n        }\n    }, {\n        key: 'getNewArrow',\n\n\n        //获得新箭头\n        value: function getNewArrow() {\n            var urls = \"?method=getLinkByPanoID&panoID=\" + constants.c_StationInfo.panoID;\n            $.ajax({\n                url: this.musServerURL + urls,\n                type: 'GET',\n                cache: true,\n                dataType: 'json',\n                error: function error(data) {\n                    console.log(\"网络连接错误，请刷新重试！\");\n                },\n                success: function success(data) {\n                    if (data.Link) {\n                        data.Link.map(function (obj) {\n                            constants.c_ArrowPanoInfoArr.push(new _ArrowInfo2.default(obj, 2));\n                        });\n                    }\n                }\n            });\n        }\n    }, {\n        key: 'getOtherPanoByPosition',\n\n\n        /**\r\n         * 地面跳转\r\n         * */\n        value: function getOtherPanoByPosition(x, y, z, panoid) {\n            var urls = \"/GetOtherPanoByPosition1?TolerateZ=5&Tolerate=100&Z=\" + z + \"&Y=\" + y + \"&ImageID=\" + panoid + \"&X=\" + x;\n            $.ajax({\n                url: this.serverURL + urls,\n                type: 'GET',\n                cache: true,\n                dataType: 'json',\n                error: function error(data) {\n                    console.log(\"网络连接错误，请刷新重试！\");\n                },\n                success: function success(data) {\n                    if (constants.c_isPreviewImageLoadEnd && constants.c_stationInfo.panoid != data.GetOtherPanoByPositionResult.ImageID) {\n                        constants.c_isPreviewImageLoadEnd = false;\n                        constants.c_stationInfo = new _StationInfo2.default(data.GetOtherPanoByPositionResult);\n                        // SWPanoView.swMinMap.init();\n                        // if (SWPanoView.swSkySphere) {\n                        //     SWPanoView.swSkySphere.initSkySphere();\n                        // } else if (SWPanoView.swSkyBox) {\n                        //     SWPanoView.swSkyBox.initBox(SWPanoView.stationInfo);\n                        // }\n                    }\n                }\n            });\n        }\n    }]);\n\n    return ServerData;\n}();\n\nexports.default = ServerData;",null]}